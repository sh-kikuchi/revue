__NUXT_JSONP__("/blog/laravel/011_policy", (function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X){return {data:[{content:{slug:"011_policy",description:"削除処理を例に",title:"Policyの実装",category:"Laravel",createdAt:N,updatedAt:N,sortNumber:11,toc:[],body:{type:"root",children:[{type:b,tag:s,props:{id:"1-はじめに"},children:[{type:b,tag:t,props:{ariaHidden:u,href:"#1-%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB",tabIndex:v},children:[{type:b,tag:c,props:{className:[w,x]},children:[]}]},{type:a,value:"1. はじめに"}]},{type:a,value:f},{type:b,tag:o,props:{},children:[{type:a,value:"例えば、君がいるだーけでこころ…ああああ違う。\r\n例えば、ログインユーザーではない人が削除処理のURLを叩くことで処理を動かしてしまうとしたら。\r\n怖いね。なので自分しか削除できないようにしたい、そんな権限を設定したい。"}]},{type:a,value:f},{type:b,tag:y,props:{},children:[]},{type:a,value:f},{type:b,tag:s,props:{id:"2--php-artisanでまずはファイル生成"},children:[{type:b,tag:t,props:{ariaHidden:u,href:"#2--php-artisan%E3%81%A7%E3%81%BE%E3%81%9A%E3%81%AF%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E7%94%9F%E6%88%90",tabIndex:v},children:[{type:b,tag:c,props:{className:[w,x]},children:[]}]},{type:a,value:"2.  php artisanでまずはファイル生成"}]},{type:a,value:f},{type:b,tag:H,props:{className:[I]},children:[{type:b,tag:J,props:{className:[K,"language-text"]},children:[{type:b,tag:q,props:{},children:[{type:a,value:"　php artisan make:policy CommentPolicy\n"}]}]}]},{type:a,value:f},{type:b,tag:o,props:{},children:[{type:a,value:"プロジェクトディレクトリで上記コマンドを叩く。\r\n"},{type:b,tag:q,props:{},children:[{type:a,value:"app\u002FPolicies"}]},{type:a,value:"内に"},{type:b,tag:q,props:{},children:[{type:a,value:"CommentPolicy.php"}]},{type:a,value:"ファイルが生成される。この時、このファイル内でデフォルトとしてUserモデルと●●Policy、ここではCommentモデルが使えるようになっているよ。"}]},{type:a,value:f},{type:b,tag:y,props:{},children:[]},{type:a,value:f},{type:b,tag:s,props:{id:"3-policyファイル内の編集"},children:[{type:b,tag:t,props:{ariaHidden:u,href:"#3-policy%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E5%86%85%E3%81%AE%E7%B7%A8%E9%9B%86",tabIndex:v},children:[{type:b,tag:c,props:{className:[w,x]},children:[]}]},{type:a,value:"3. Policyファイル内の編集"}]},{type:a,value:f},{type:b,tag:o,props:{},children:[{type:a,value:"※CommentPolicy"}]},{type:a,value:f},{type:b,tag:H,props:{className:[I]},children:[{type:b,tag:J,props:{className:[K,O]},children:[{type:b,tag:q,props:{},children:[{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:P}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:i}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,Q,i]},children:[{type:a,value:R}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,z,A]},children:[{type:a,value:"User"}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,h]},children:[{type:a,value:S}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:B}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,z,A]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,h]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:m}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:C}]},{type:a,value:D},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:T}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,h]},children:[{type:a,value:S}]},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:M}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:"==="}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,h]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:"user_id"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:F}]},{type:a,value:f}]}]}]},{type:a,value:f},{type:b,tag:o,props:{},children:[{type:a,value:"ログインユーザーとコメントを書いたユーザーが一致したら削除処理出来るよっていう意味じゃ。"}]},{type:a,value:f},{type:b,tag:y,props:{},children:[]},{type:a,value:f},{type:b,tag:s,props:{id:"4-コントローラーでpolicyの読み込み"},children:[{type:b,tag:t,props:{ariaHidden:u,href:"#4-%E3%82%B3%E3%83%B3%E3%83%88%E3%83%AD%E3%83%BC%E3%83%A9%E3%83%BC%E3%81%A7policy%E3%81%AE%E8%AA%AD%E3%81%BF%E8%BE%BC%E3%81%BF",tabIndex:v},children:[{type:b,tag:c,props:{className:[w,x]},children:[]}]},{type:a,value:"4. コントローラーでpolicyの読み込み"}]},{type:a,value:f},{type:b,tag:o,props:{},children:[{type:a,value:"※CommentController"}]},{type:a,value:f},{type:b,tag:H,props:{className:[I]},children:[{type:b,tag:J,props:{className:[K,O]},children:[{type:b,tag:q,props:{},children:[{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:P}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:i}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,Q,i]},children:[{type:a,value:R}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,z,A]},children:[{type:a,value:"chat"}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,h]},children:[{type:a,value:U}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:B}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,z,A]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,h]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:m}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:C}]},{type:a,value:D},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:"try"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:C}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,"this",k]},children:[{type:a,value:"$this"}]},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:"authorize"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,V,W]},children:[{type:a,value:"'destroy'"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:B}]},{type:b,tag:c,props:{className:[d,h]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,h]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:"="}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,"scope"]},children:[{type:a,value:L},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:"::"}]}]},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:"find"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,h]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:n}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:M}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,h]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:"delete"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:D},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:F}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:"catch"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,z,"class-name-fully-qualified"]},children:[{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:"\\"}]},{type:a,value:"Exception"}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,h]},children:[{type:a,value:X}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:C}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,h]},children:[{type:a,value:X}]},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:"getMessage"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:D},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:F}]},{type:a,value:"\n\n    "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:T}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:"redirect"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,i]},children:[{type:a,value:"route"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,V,W]},children:[{type:a,value:"'comment.show'"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:B}]},{type:b,tag:c,props:{className:[d,h]},children:[{type:a,value:U}]},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:M}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:r}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:F}]},{type:a,value:f}]}]}]},{type:a,value:f},{type:b,tag:o,props:{},children:[{type:a,value:"↑\r\n"},{type:b,tag:q,props:{},children:[{type:a,value:"$this-\u003Eauthorize('destroy',$comment);"}]},{type:a,value:"でpolicyファイル内のdestroyメソッドで権限があるかどうかを判定するんだ。へぇ。"}]},{type:a,value:f},{type:b,tag:y,props:{},children:[]},{type:a,value:f},{type:b,tag:s,props:{id:"5-おわりに"},children:[{type:b,tag:t,props:{ariaHidden:u,href:"#5-%E3%81%8A%E3%82%8F%E3%82%8A%E3%81%AB",tabIndex:v},children:[{type:b,tag:c,props:{className:[w,x]},children:[]}]},{type:a,value:"5. おわりに"}]},{type:a,value:f},{type:b,tag:o,props:{},children:[{type:a,value:"特定の人しか削除されないように、削除ボタンの表示と非表示を権限の如何で切り替えたり、\r\n今回のようにポリシー設定をしたりとセキュリティ対策をしましょうってことだけど、\r\n削除は気ぃつかう(;´･ω･)。メンドクナッタラニゲロ。"}]},{type:a,value:f},{type:b,tag:y,props:{},children:[]}]},dir:"\u002Fblog\u002Flaravel",path:"\u002Fblog\u002Flaravel\u002F011_policy",extension:".md"},navigation:"blog\u002Flaravel",dirParam:"laravel"}],fetch:{},mutations:[]}}("text","element","span","token","punctuation","\n"," ","variable","function","operator","keyword","(",")","-\u003E","p","$comment","code",";","h1","a","true",-1,"icon","icon-link","br","class-name","type-declaration",",","{","\n    ","property","}","\n        ","div","nuxt-content-highlight","pre","line-numbers","Comment","id","2022-04-13T00:00:00.000Z","language-php","public","function-definition","destroy","$user","return","$chat","string","single-quoted-string","$e")));