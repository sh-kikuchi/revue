__NUXT_JSONP__("/blog/php/003_fragile", (function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_,$,aa,ab,ac,ad,ae,af,ag,ah,ai,aj){return {data:[{content:{slug:"003_fragile",description:"XSS対策と認証用トークン生成",title:"脆弱性とトークン",category:H,createdAt:"2022-01-29T00:00:00.000Z",updatedAt:"2022-03-19T00:00:00.000Z",sortNumber:I,toc:[{id:R,depth:I,text:S},{id:T,depth:I,text:U}],body:{type:"root",children:[{type:b,tag:J,props:{id:"1-はじめに"},children:[{type:b,tag:n,props:{href:"#1-%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB",ariaHidden:r,tabIndex:s},children:[{type:b,tag:c,props:{className:[t,u]},children:[]}]},{type:a,value:"1. はじめに"}]},{type:a,value:f},{type:b,tag:o,props:{},children:[{type:a,value:"地味に次回以降にご活躍の"},{type:b,tag:i,props:{},children:[{type:a,value:w}]},{type:a,value:"とXSS対策をしてみましょう。認証をはじめ、様々な場面で使えるものでセキュリティ対策になるので、必見（誰に対して放っている言葉なのか）。"}]},{type:a,value:f},{type:b,tag:x,props:{className:[y]},children:[{type:b,tag:z,props:{className:[A,"language-text"]},children:[{type:b,tag:i,props:{},children:[{type:a,value:"プロジェクトディレクトリ\n│\n│── fragile\n│   │── index.php ←【今回、ココ】\n│\n"}]}]}]},{type:a,value:f},{type:b,tag:K,props:{},children:[]},{type:a,value:f},{type:b,tag:J,props:{id:"2-トークン生成とxss対策用のファイルを用意"},children:[{type:b,tag:n,props:{href:"#2-%E3%83%88%E3%83%BC%E3%82%AF%E3%83%B3%E7%94%9F%E6%88%90%E3%81%A8xss%E5%AF%BE%E7%AD%96%E7%94%A8%E3%81%AE%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%82%92%E7%94%A8%E6%84%8F",ariaHidden:r,tabIndex:s},children:[{type:b,tag:c,props:{className:[t,u]},children:[]}]},{type:a,value:"2. トークン生成とXSS対策用のファイルを用意"}]},{type:a,value:f},{type:b,tag:x,props:{className:[y]},children:[{type:b,tag:z,props:{className:[A,B]},children:[{type:b,tag:i,props:{},children:[{type:b,tag:c,props:{className:[d,H,B]},children:[{type:b,tag:c,props:{className:[d,V,W]},children:[{type:a,value:"\u003C?php"}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,p]},children:[{type:a,value:h}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,L,h]},children:[{type:a,value:"h"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:M}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:N}]},{type:a,value:v},{type:b,tag:c,props:{className:[d,p]},children:[{type:a,value:O}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,h]},children:[{type:a,value:w}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:M}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:C}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,X]},children:[{type:a,value:P}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:C}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,D,E]},children:[{type:a,value:Y}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:m}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:Q}]},{type:a,value:"\n\n"},{type:b,tag:c,props:{className:[d,p]},children:[{type:a,value:h}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,L,h]},children:[{type:a,value:Z}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:N}]},{type:a,value:v},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:q}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,F]},children:[{type:a,value:G}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,h]},children:[{type:a,value:_}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:b,tag:c,props:{className:[d,h]},children:[{type:a,value:$}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:b,tag:c,props:{className:[d,aa]},children:[{type:a,value:ab}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:m}]},{type:a,value:v},{type:b,tag:c,props:{className:[d,ac]},children:[{type:a,value:ad}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:ae}]},{type:b,tag:c,props:{className:[d,D,E]},children:[{type:a,value:af}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:ag}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,F]},children:[{type:a,value:G}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:q}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:m}]},{type:a,value:ah},{type:b,tag:c,props:{className:[d,p]},children:[{type:a,value:O}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:q}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:m}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:Q}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,V,W]},children:[{type:a,value:"?\u003E"}]}]},{type:a,value:f}]}]}]},{type:a,value:f},{type:b,tag:ai,props:{id:R},children:[{type:b,tag:n,props:{href:"#-htmlspecialchars%E9%96%A2%E6%95%B0",ariaHidden:r,tabIndex:s},children:[{type:b,tag:c,props:{className:[t,u]},children:[]}]},{type:a,value:S}]},{type:a,value:f},{type:b,tag:aj,props:{},children:[{type:a,value:f},{type:b,tag:o,props:{},children:[{type:a,value:"HTML タグ(「&」「\"」「'」「\u003C」「\u003E」など)などに使われる特殊文字をエンティティに変換する関数。"}]},{type:a,value:f}]},{type:a,value:f},{type:b,tag:x,props:{className:[y]},children:[{type:b,tag:z,props:{className:[A,B]},children:[{type:b,tag:i,props:{},children:[{type:a,value:g},{type:b,tag:c,props:{className:[d,h]},children:[{type:a,value:w}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:M}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:C}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,X]},children:[{type:a,value:P}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:C}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,D,E]},children:[{type:a,value:Y}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:m}]},{type:a,value:f}]}]}]},{type:a,value:f},{type:b,tag:o,props:{},children:[{type:a,value:"上記のように関数のパラメータは"},{type:b,tag:i,props:{},children:[{type:a,value:" htmlspecialchars( 文字列, 変換パターン, 文字コード )"}]},{type:a,value:"です。"},{type:b,tag:i,props:{},children:[{type:a,value:P}]},{type:a,value:"の部分に関して、「‘」は「'」、「“」は「\"」といった具体にシングルとダブルの引用符の特殊文字をちゃんと画面に表示できるように変換します。"}]},{type:a,value:f},{type:b,tag:o,props:{},children:[{type:a,value:"参考 "},{type:b,tag:n,props:{href:"https:\u002F\u002Fwww.php.net\u002Fmanual\u002Fja\u002Ffunction.htmlspecialchars.php",rel:["nofollow","noopener","noreferrer"],target:"_blank"},children:[{type:a,value:"PHPのドキュメント"}]}]},{type:a,value:f},{type:b,tag:K,props:{},children:[]},{type:a,value:f},{type:b,tag:ai,props:{id:T},children:[{type:b,tag:n,props:{href:"#-%E3%83%88%E3%83%BC%E3%82%AF%E3%83%B3%E3%81%AE%E7%94%9F%E6%88%90",ariaHidden:r,tabIndex:s},children:[{type:b,tag:c,props:{className:[t,u]},children:[]}]},{type:a,value:U}]},{type:a,value:f},{type:b,tag:aj,props:{},children:[{type:a,value:f},{type:b,tag:o,props:{},children:[{type:a,value:"CSRF（クロスサイト・リクエスト・フォージェリ）の対策のためにトークンを生成します。簡単にいうと、フォーム入力前のWebページで予めトークンを発行することでリクエスト時に送信されたトークンと入力前のトークンを比較し、正しいリクエスト元であるかどうかを判別する。"}]},{type:a,value:f}]},{type:a,value:f},{type:b,tag:x,props:{className:[y]},children:[{type:b,tag:z,props:{className:[A,B]},children:[{type:b,tag:i,props:{},children:[{type:b,tag:c,props:{className:[d,p]},children:[{type:a,value:h}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,L,h]},children:[{type:a,value:Z}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:N}]},{type:a,value:v},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:q}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,F]},children:[{type:a,value:G}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,h]},children:[{type:a,value:_}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:b,tag:c,props:{className:[d,h]},children:[{type:a,value:$}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:b,tag:c,props:{className:[d,aa]},children:[{type:a,value:ab}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:l}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:m}]},{type:a,value:v},{type:b,tag:c,props:{className:[d,ac]},children:[{type:a,value:ad}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:ae}]},{type:b,tag:c,props:{className:[d,D,E]},children:[{type:a,value:af}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:ag}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,F]},children:[{type:a,value:G}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:q}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:m}]},{type:a,value:ah},{type:b,tag:c,props:{className:[d,p]},children:[{type:a,value:O}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:q}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:m}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:Q}]},{type:a,value:f}]}]}]},{type:a,value:f},{type:b,tag:K,props:{},children:[]},{type:a,value:f},{type:b,tag:J,props:{id:"3-おわりに"},children:[{type:b,tag:n,props:{href:"#3-%E3%81%8A%E3%82%8F%E3%82%8A%E3%81%AB",ariaHidden:r,tabIndex:s},children:[{type:b,tag:c,props:{className:[t,u]},children:[]}]},{type:a,value:"3. おわりに"}]},{type:a,value:f},{type:b,tag:o,props:{},children:[{type:a,value:"トークンの生成は思いのほか、少ない行の記述で出来るし、"},{type:b,tag:i,props:{},children:[{type:a,value:w}]},{type:a,value:"も毎回、"},{type:b,tag:i,props:{},children:[{type:a,value:"\u003C?php echo htmlspecialchars() ?\u003E"}]},{type:a,value:"って書くのは面倒だからそれが、"},{type:b,tag:i,props:{},children:[{type:a,value:"\u003C?php echo h() ?\u003E"}]},{type:a,value:"で済むなんて…、なんて革命。"}]}]},dir:"\u002Fblog\u002Fphp",path:"\u002Fblog\u002Fphp\u002F003_fragile",extension:".md"},navigation:"blog\u002Fphp",dirParam:H}],fetch:{},mutations:[]}}("text","element","span","token","punctuation","\n"," ","function","code","(","variable",")",";","a","p","keyword","$csrf_token","true",-1,"icon","icon-link","\n    ","htmlspecialchars","div","nuxt-content-highlight","pre","line-numbers","language-php",",","string","single-quoted-string","operator","=","php",3,"h1","br","function-definition","$str","{","return","ENT_QUOTES","}","-htmlspecialchars関数","■ htmlspecialchars関数","-トークンの生成","■ トークンの生成","delimiter","important","constant","'UTF-8'","setToken","bin2hex","random_bytes","number","32","global","$_SESSION","[","'csrf_token'","]","\n\n    ","h3","blockquote")));